import axios from 'axios';

export async function analyzeCode(apiKey: string, code: string): Promise<any> {
    const response = await axios.post(
        'https://api.openai.com/v1/chat/completions',
        {
            model: "gpt-4",
            messages: [
                {
                    role: "system",
                    content: "You are a cybersecurity expert analyzing Solidity code."
                },
                {
                    role: "user",
                    content: `Analyze the following Solidity code for vulnerabilities:\n\n${code}`
                }
            ],
        },
        {
            headers: {
                'Authorization': `Bearer ${apiKey}`,
                'Content-Type': 'application/json',
            }
        }
    );
    return response.data;
}
